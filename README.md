# Codon_analysis_pipeline
# Codon Heatmap and UMAP Analysis in MATLAB

MATLAB scripts for extracting codon usage from CDS FASTA files (NCBI) and visualizing codon or amino acid clustering using UMAP and heatmaps.  
This repository contains two scripts:

0. **Start with a list of CDS in a FASTA file**  
   - This can be parsed from NCBI genomes (https://www.ncbi.nlm.nih.gov/datasets/genome/)
   - Download genomic coding sequence FASTA files from NCBI, example with Salmonella LT2 (https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000006945.2/)

1. **`Extract_Codon_Usage.m`**  
   - Extracts codon frequencies per gene.  
   - Collects gene metadata (locus tag, gene symbol, Entrez ID, protein description, RefSeq protein ID, UniProt ID).  
   - Exports two Excel files:  
     - `*_codons.xlsx` → codon frequency table.  
     - `*_geneIDs.xlsx` → gene metadata table.  
   - Export one txt file containing the average GC% in the genome: "GC_content.txt"

2. **`Codon_Usage_UMAP_Heatmap.m`**  
   - Load the codon frequency table (generated by previous script)  
   - Computes amino acid and relative codon usage.  
   - Runs [UMAP](https://www.mathworks.com/matlabcentral/fileexchange/71902-run_umap) for dimensionality reduction.  
   - Performs hierarchical clustering to reorder genes and codons.  
   - Generates heatmaps and UMAP scatter plots.  
   - Exports one Excel file: `*_codons_UMAP.xlsx` → Excel file with codon usage tables, UMAP projections, reordered gene list, and codon order
   - Exports one figure "UMAP_Heatmap.jpeg"

---

## Dependencies

- **MATLAB R2020a or newer**   
- **Bioinformatics Toolbox** (for `fastaread`, `codoncount`)  
- **Statistics and Machine Learning Toolbox** (for `pdist`, `linkage`)  
- **[run_umap toolbox](https://www.mathworks.com/matlabcentral/fileexchange/71902-run_umap)`** (download from MATLAB File Exchange and add to your path)

---

## Repository Structure

codon-heatmap-matlab/
├─ Extract_Codon_Usage.m
├─ Codon_Usage_UMAP_Heatmap.m
├─ Example/
│ ├─ Example.fna
│ ├─ Example_codons.xlsx
│ ├─ Example_geneIDs.xlsx
│ └─ Example_UMAP_Heatmap.jpeg
├─ README.txt
└─ LICENSE


---

## Usage

### Step 1: Extract codon usage
1. Run `Extract_Codon_Usage.m` in MATLAB.  
2. When prompted, select a CDS FASTA file from NCBI (e.g., `Example/Example.fna`).  
3. Outputs will be saved in the same folder:
   - `Example_codons.xlsx` (codon frequency table)  
   - `Example_geneIDs.xlsx` (gene metadata table)  
   - `GC_content.txt` (genome GC%)  

### Step 2: Generate codon heatmap and UMAP clustering
1. Run `Codon_Usage_UMAP_Heatmap.m` in MATLAB.  
2. Select the codon Excel file generated in Step 1 (e.g., `example_codons.xlsx`).  
3. The script will auto-detect the matching gene metadata file.  
4. Outputs include:  
   - Codon usage heatmap (`genes_usage_colorbar.jpeg`, `.emf`)  
   - Excel file with codon usage tables, UMAP projections, reordered gene list, and codon order (`*_UMAP.xlsx`)

---

## Example

An example dataset of cds (`Example/Example.fna`) is provided.  


---

## Citation

If you use these scripts in your research, please cite:

Goormaghtigh F. Codon Heatmap and UMAP Analysis in MATLAB. GitHub repository: https://github.com/yourusername/codon-heatmap-matlab
. DOI: (to be generated via Zenodo).
